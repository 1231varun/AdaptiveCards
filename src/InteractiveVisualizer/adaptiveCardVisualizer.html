<!DOCTYPE html>

<html lang="en">
<head>
    <meta charset="utf-8" />
    <title>Adaptive Card Visualizer</title>

    <link rel="stylesheet" href="./css/adaptivecard.css" type="text/css" />
    <link rel="stylesheet" href="./css/controls.css" type="text/css" />
    <link rel="stylesheet" href="./css/app.css" type="text/css" />

	<script src="https://cdn.jsdelivr.net/markdown-it/7.0.0/markdown-it.min.js"></script>
    <script src="ace/src-min/ace.js" type="text/javascript" charset="utf-8"></script>

    <script src="js/adaptivecard.js"></script>
    <script src="js/app.js"></script>    
</head>
<body>
    <div class="uiRoot">
        <div class="cardEditor">
            <div class="markup">
                <div id="editor">

{
	"@type": "AdaptiveCard",
	"sections": [
		{
			"items": [
				{
					"@type": "TextBlock",
					"text": "This is a text element",
					"style": "sectionTitle",
					"textSize": "large"
				},
				{
					"@type": "Picture",
					"url": "http://connectorsdemo.azurewebsites.net/images/MicrosoftSurface_024_Cafe_OH-06315_VS_R1c.jpg",
					"size": "medium"
				},
				{
					"@type": "FactGroup",
					"topSpacing": "normal",
					"items": [
						{
							"name": "This is a fact name",
							"value": "This is a fact value"
						},
						{
							"name": "This is a fact name",
							"value": "This is a fact value"
						},
						{
							"name": "This is a fact name",
							"value": "This is a fact value"
						}
					]
				},
				{
				    "@type": "DateInput",
					"topSpacing": "normal"
				},
				{
				    "@type": "TextInput",
				    "topSpacing": "narrow",
				    "title": "Enter text here"
				},
				{
				    "@type": "MultichoiceInput",
				    "topSpacing": "narrow",
				    "choices": [
				        { "display": "Choice 1", "value": "1" },
				        { "display": "Choice 2", "value": "2" },
				        { "display": "Choice 3", "value": "3" }
				    ]
				},
				{
					"@type": "PictureGallery",
					"topSpacing": "normal",
					"imageSize": "medium",
					"items": [
						"http://connectorsdemo.azurewebsites.net/images/MicrosoftSurface_024_Cafe_OH-06315_VS_R1c.jpg",
						"http://connectorsdemo.azurewebsites.net/images/WIN12_Scene_01.jpg",
						"http://connectorsdemo.azurewebsites.net/images/WIN12_Anthony_02.jpg"
					]
				},
				{
					"@type": "ActionGroup",
					"topSpacing": "normal",
					"items": [
						{
							"@type": "ActionCard",
							"name": "Comment",
							"card": {
							    "items": [
							        {
							            "@type": "ColumnGroup",
							            "items": [
							                {
							                    "size": 50,
							                    "items": [
							                        {
							                            "@type": "TextInput"
							                        }
							                    ]
							                },
							                {
							                    "size": 50,
							                    "items": [
							                        {
							                            "@type": "DateInput",
							                            "size": "stretch"
							                        },
							                        {
                    									"@type": "MultichoiceInput",
							                            "size": "stretch",
                    									"topSpacing": "narrow",
                    									"id": "list",
                    									"title": "Pick an option",
                    									"choices": [
                    										{
                    											"display": "Choice 1",
                    											"value": "1"
                    										},
                    										{
                    											"display": "Choice 2",
                    											"value": "2"
                    										},
                    										{
                    											"display": "Choice 3",
                    											"value": "3"
                    										}
                    									]
							                        }
							                    ]
							                }
							            ]
							        },
							        {
							            "@type": "TextInput",
							            "topSpacing": "narrow"
							        }
							    ]
							},
							"inputs": [
								{

									"@type": "TextInput",
									"id": "comment",
									"isMultiline": true,
									"title": "Input's title property"
								}
							],
							"actions": [
								{
									"@type": "HttpPOST",
									"name": "Action's name prop.",
									"target": "http://...",
									"successMessage": "This is the action's successMessage property.",

									"errorMessage": "This is the action's errorMessage property."
								}
							]
						},
						{
							"@type": "ActionCard",
							"name": "Move",
							"inputs": [
								{
									"@type": "MultichoiceInput",
									"id": "list",
									"title": "Pick an option",
									"choices": [
										{
											"display": "Choice 1",
											"value": "1"
										},
										{
											"display": "Choice 2",
											"value": "2"
										},
										{
											"display": "Choice 3",
											"value": "3"
										}
									]
								}
							],
							"actions": [
								{
									"@type": "HttpPOST",
									"name": "Action's name prop.",
									"target": "http://...",
									"successMessage": "This is the action's successMessage property.",
									"errorMessage": "This is the action's errorMessage property."
								}
							]
						},
						{
							"@type": "ActionCard",
							"name": "Due Date",
							"inputs": [
								{
									"@type": "DateInput",
									"id": "dueDate",
									"title": "Input's title property"
								}
							],
							"actions": [
								{
									"@type": "HttpPOST",
									"name": "Action's name prop.",
									"target": "http://...",
									"successMessage": "This is the action's successMessage property.",
									"errorMessage": "This is the action's errorMessage property."

								}
							]
						},
						{
							"@type": "HttpPOST",

							"name": "Action's name prop.",
							"target": "http://...",
							"successMessage": "This is the action's successMessage property.",
							"errorMessage": "This is the action's errorMessage property."
						},
						{
							"@type": "OpenUri",
							"name": "Action's name prop",
							"targets": [
								{
									"os": "default",
									"uri": "http://..."
								}
							]
						}
					]
				}
			]
		},
		{
			"topSpacing": "normal",
			"items": [
				{
					"@type": "Separator"
				},
				{
					"@type": "TextBlock",
		        	"topSpacing": "normal",
					"text": "Second section",
					"textSize": "large",
					"style": "sectionTitle"
				},
				{
					"@type": "ColumnGroup",
        			"topSpacing": "normal",
					"items": [
						{
							"size": "auto",
							"items": [
                				{
                					"@type": "Picture",
                					"url": "http://connectorsdemo.azurewebsites.net/images/MSC12_Oscar_002.jpg",
                					"size": "small"
                				}
							]
						},
						{
							"size": "stretch",
							"items": [
							    {
							        "@type": "TextBlock",
							        "text": "This is the activityTitle property",
							        "style": "activityTitle"
							    },
							    {
							        "@type": "TextBlock",
							        "text": "This is the activitySubtitle property",
							        "style": "activitySubtitle",
									"topSpacing": "none"
							    },
							    {
							        "@type": "TextBlock",
							        "text": "This is the activityText property",
							        "style": "activityText",
									"topSpacing": "none"
							    }
							]
						},
						{
						    "size": "large",
						    "items": [
                				{
                				    "@type": "DateInput",
                				    "size": "stretch"
                				},
                				{
                				    "@type": "TextInput",
                				    "topSpacing": "narrow",
                				    "title": "Enter text here"
                				},
                				{
                				    "@type": "MultichoiceInput",
                				    "size": "stretch",
                				    "topSpacing": "narrow",
                				    "choices": [
                				        { "display": "Choice 1", "value": "1" },
                				        { "display": "Choice 2", "value": "2" },
                				        { "display": "Choice 3", "value": "3" }
                				    ]
                				}
						    ]
						}
					]
				}
			]
		}
	]
}
                </div>
            </div>
            <div class="markupRenderContainer">
                <div id="content" class="markupRender"></div>
            </div>
        </div>
        <div class="uiFooter">
            <div style="width: 0px; height: 0px; overflow: hidden">
                <input type="file" id="filePicker" />
            </div>
			<span>
            	<button onclick="openFilePicker();">Load sample from file...</button>
				<select id="hostContainerPicker" style="select multichoiceInput"/>
			</span>
        </div>
    </div>
    <script>
        markdownProcessor = window.markdownit();

        editor = ace.edit("editor");
        editor.setTheme("ace/theme/chrome");
        editor.setOptions(
            {
                "showPrintMargin": false,
                "displayIndentGuides": false,
                "showFoldWidgets": false,
                "highlightSelectedWord": false,
                "fontSize": "14px"
            });
        editor.getSession().setMode("ace/mode/json");
        editor.getSession().on(
            'change',
            function(e) { renderCard(); });
    </script>
</body>
</html>
