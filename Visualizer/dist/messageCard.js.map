{"version":3,"sources":["messageCard.ts"],"names":[],"mappings":"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","file":"messageCard.js","sourcesContent":["function parsePicture(container: Container, json: any, defaultSize: Size = Size.Medium, defaultStyle: PictureStyle = PictureStyle.Normal): Picture {\r\n    let picture = new Picture(container);\r\n\r\n    picture.url = json[\"image\"];\r\n    picture.size = Size.parse(json[\"size\"], defaultSize);\r\n\r\n    return picture;\r\n}\r\n\r\nfunction parsePictureGallery(container: Container, json: any): PictureGallery {\r\n    let pictureGallery = new PictureGallery(container);\r\n    let pictureArray = json as Array<any>;\r\n\r\n    for (var i = 0; i < pictureArray.length; i++) {\r\n        let picture = parsePicture(container, pictureArray[i], Size.Large);\r\n\r\n        pictureGallery.items.push(picture);\r\n    }\r\n\r\n    return pictureGallery;\r\n}\r\n\r\nfunction parseFactGroup(container: Container, json: any): FactGroup {\r\n    let factGroup = new FactGroup(container);\r\n    let factArray = json as Array<any>;\r\n\r\n    for (var i = 0; i < factArray.length; i++) {\r\n        let fact = new Fact();\r\n\r\n        fact.parse(factArray[i]);\r\n\r\n        factGroup.items.push(fact);\r\n    }\r\n\r\n    return factGroup;\r\n}\r\n\r\nfunction parseActionGroup(container: Container, json: any): ActionGroup {\r\n    let actionGroup = new ActionGroup(container);\r\n    let actionArray = json as Array<any>;\r\n\r\n    for (var i = 0; i < actionArray.length; i++) {\r\n        let action = Action.create(actionGroup, actionArray[i][\"@type\"]);\r\n\r\n        action.parse(actionArray[i]);\r\n\r\n        actionGroup.actions.push(action);\r\n    }\r\n\r\n    return actionGroup;\r\n}\r\n\r\nfunction parseSection(container: Container, json: any): Container {\r\n    let section = new Container(container, [ \"Section\" ]);\r\n\r\n    if (json[\"startGroup\"] === true) {\r\n        section.addElement(new Separator(section));\r\n    }\r\n\r\n    let textBlock = new TextBlock(section);\r\n    textBlock.text = json[\"title\"];\r\n    textBlock.textSize = TextSize.Large;\r\n\r\n    section.addElement(textBlock);\r\n\r\n    if (json[\"style\"] == \"emphasis\") {\r\n        section.backgroundColor = \"#F8F8F8\";\r\n    }\r\n\r\n    if (json[\"activityTitle\"] != undefined || json[\"activitySubtitle\"] != undefined ||\r\n        json[\"activityText\"] != undefined || json[\"activityImage\"] != undefined) {\r\n\r\n        let columnGroup = new ColumnGroup(container);\r\n\r\n        // Image column\r\n        if (json[\"activityImage\"] != null) {\r\n            let column = columnGroup.addColumn();\r\n            column.size = Size.Auto;\r\n\r\n            let picture = new Picture(column);\r\n            picture.size = Size.Small;\r\n            picture.style = PictureStyle.Person;\r\n            picture.url = json[\"activityImage\"];\r\n\r\n            column.addElement(picture);\r\n        }\r\n\r\n        // Text column\r\n        let column = columnGroup.addColumn();\r\n        column.size = Size.Stretch;\r\n\r\n        if (json[\"activityTitle\"] != null) {\r\n            let textBlock = new TextBlock(column);\r\n            textBlock.text = json[\"activityTitle\"];\r\n\r\n            column.addElement(textBlock);\r\n        }\r\n\r\n        if (json[\"activitySubtitle\"] != null) {\r\n            let textBlock = new TextBlock(column);\r\n            textBlock.text = json[\"activitySubtitle\"];\r\n            textBlock.textWeight = TextWeight.Lighter;\r\n            textBlock.isSubtle = true;\r\n            textBlock.topSpacing = Spacing.None;\r\n\r\n            column.addElement(textBlock);\r\n        }\r\n\r\n        if (json[\"activityText\"] != null) {\r\n            let textBlock = new TextBlock(column);\r\n            textBlock.text = json[\"activityText\"];\r\n            textBlock.topSpacing = Spacing.None;\r\n\r\n            column.addElement(textBlock);\r\n        }\r\n\r\n        section.addElement(columnGroup);\r\n    }\r\n\r\n    if (json[\"heroImage\"] != undefined) {\r\n        let picture = new Picture(section);\r\n        picture.size = Size.Auto;\r\n        picture.url = json[\"heroImage\"];\r\n\r\n        section.addElement(picture);\r\n    }\r\n\r\n    let text = new TextBlock(section);\r\n    text.text = json[\"text\"];\r\n\r\n    section.addElement(text);\r\n\r\n    if (json[\"facts\"] != undefined) {\r\n        let factGroup = parseFactGroup(section, json[\"facts\"]);\r\n\r\n        section.addElement(factGroup);\r\n    }\r\n\r\n    if (json[\"images\"] != undefined) {\r\n        let pictureGallery = parsePictureGallery(section, json[\"images\"]);\r\n\r\n        section.addElement(pictureGallery);\r\n    }\r\n\r\n    if (json[\"potentialAction\"] != undefined) {\r\n        let actionGroup = parseActionGroup(section, json[\"potentialAction\"]);\r\n\r\n        section.addElement(actionGroup);\r\n    }\r\n\r\n    return section;\r\n}\r\n\r\nclass MessageCard {\r\n    private _rootContainer: Container;\r\n\r\n    summary: string;\r\n    themeColor: string;\r\n\r\n    parse(json: any) {\r\n        this.summary = json[\"summary\"];\r\n        this.themeColor = json[\"themeColor\"];\r\n\r\n        this._rootContainer = new Container(null);\r\n        this._rootContainer.topSpacing = Spacing.None;\r\n\r\n        if (json[\"title\"] != null) {\r\n            let textBlock = new TextBlock(this._rootContainer);\r\n            textBlock.text = json[\"title\"];\r\n            textBlock.textSize = TextSize.ExtraLarge;\r\n\r\n            this._rootContainer.addElement(textBlock);\r\n        }\r\n\r\n        if (json[\"text\"] != null) {\r\n            let textBlock = new TextBlock(this._rootContainer);\r\n            textBlock.text = json[\"text\"],\r\n\r\n            this._rootContainer.addElement(textBlock);\r\n        }\r\n\r\n        if (json[\"sections\"] != undefined) {\r\n            let sectionArray = json[\"sections\"] as Array<any>;\r\n\r\n            for (var i = 0; i < sectionArray.length; i++) {\r\n                let section = parseSection(this._rootContainer, sectionArray[i]);\r\n\r\n                if (i == 0 && this._rootContainer.elementCount == 0) {\r\n                    section.topSpacing = Spacing.None;\r\n                }\r\n\r\n                this._rootContainer.addElement(section);\r\n            }\r\n        }\r\n\r\n        if (json[\"potentialAction\"] != undefined) {\r\n            let actionGroup = parseActionGroup(this._rootContainer, json[\"potentialAction\"]);\r\n\r\n            this._rootContainer.addElement(actionGroup);\r\n        }\r\n    }\r\n\r\n    render(): HTMLElement {\r\n        let element = document.createElement(\"div\");\r\n\r\n        if (isNullOrEmpty(this.themeColor)) {\r\n            element.style.border = \"1px solid #F1F1F1\"\r\n        }\r\n        else {\r\n            element.style.borderTop = \"1px solid #F1F1F1\";\r\n            element.style.borderRight = \"1px solid #F1F1F1\";\r\n            element.style.borderBottom = \"1px solid #F1F1F1\";\r\n            element.style.borderLeft = \"3px solid #\" + this.themeColor;\r\n        }\r\n\r\n        let renderedContainer = this._rootContainer.internalRender();\r\n        renderedContainer.className = \"rootContainer\";\r\n\r\n        appendChild(element, renderedContainer);\r\n\r\n        return element;\r\n    }\r\n}"]}