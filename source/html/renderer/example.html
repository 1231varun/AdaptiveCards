<!DOCTYPE html>

<html lang="en">

<head>
    <meta charset="utf-8" />
    <title>Adaptive Cards - Basic Example</title>

    <script src="dist/adaptive-cards.js"></script>

    <script>
        var configuration = {
            supportsInteractivity: true,
            strongSeparation: {
                spacing: 40,
                lineThickness: 1,
                lineColor: "#EEEEEE"
            },
            fontFamily: "Segoe UI",
            fontSizes: {
                small: 12,
                normal: 14,
                medium: 17,
                large: 21,
                extraLarge: 26
            },
            fontWeights: {
                lighter: 200,
                normal: 400,
                bolder: 600
            },
            colors: {
                dark: {
                    normal: "#333333",
                    subtle: "#EE333333"
                },
                light: {
                    normal: "#FFFFFF",
                    subtle: "#88FFFFFF"
                },
                accent: {
                    normal: "#2E89FC",
                    subtle: "#882E89FC" 
                },
                attention: {
                    normal: "#FFD800",
                    subtle: "#DDFFD800"
                },
                good: {
                    normal: "#00FF00",
                    subtle: "#DD00FF00"
                },
                warning: {
                    normal: "#FF0000",
                    subtle: "#DDFF0000"
                }
            },
            imageSizes: {
                small: 40,
                medium: 80,
                large: 160
            },
            actions: {
                maxActions: 5,
                separation: {
                    spacing: 20
                },
                buttonSpacing: 20,
                stretch: false,
                showCard: {
                    actionMode: "inlineEdgeToEdge",
                    inlineCardSpacing: 16,
                    backgroundColor: "#EFEFEF",
                    padding: {
                        top: 16,
                        right: 16,
                        bottom: 16,
                        left: 16
                    }
                },
                actionsOrientation: "horizontal",
                actionAlignment: "left"
            },
            adaptiveCard: {
//                backgroundColor: "#EFEFEF",
                padding: {
                    left: 20,
                    top: 20,
                    right: 20,
                    bottom: 20
                }
            },
            container: {
                separation: {
                    spacing: 20
                },
                normal: {
                },
                emphasis: {
                    backgroundColor: "#EEEEEE",
                    borderColor: "#AAAAAA",
                    borderThickness: {
                        top: 1,
                        right: 1,
                        bottom: 1,
                        left: 1
                    },
                    padding: {
                        top: 10,
                        right: 10,
                        bottom: 10,
                        left: 10
                    }
                }
            },
            textBlock: {
                color: "dark",
                separations: {
                    small: {
                        spacing: 20,
                    },
                    normal: {
                        spacing: 20
                    },
                    medium: {
                        spacing: 20
                    },
                    large: {
                        spacing: 20
                    },
                    extraLarge: {
                        spacing: 20
                    }
                }
            },
            image: {
                size: "medium",
                separation: {
                    spacing: 20
                }
            },
            imageSet: {
                imageSize: "medium",
                separation: {
                    spacing: 20
                }
            },
            factSet: {
                separation: {
                    spacing: 20
                },
                title: {
                    color: "dark",
                    size: "normal",
                    isSubtle: false,
                    weight: "bolder"
                },
                value: {
                    color: "dark",
                    size: "normal",
                    isSubtle: false,
                    weight: "normal"
                },
                spacing: 10
            },
            input: {
                separation: {
                    spacing: 20
                }
            },
            columnSet: {
                separation: {
                    spacing: 20
                }
            },
            column: {
                separation: {
                    spacing: 20
                }
            }
        };

        var json = {
            "$schema": "https://microsoft.github.io/AdaptiveCards/schemas/adaptive-card.json",
            "type": "AdaptiveCard",
            "version": "1.0",
            "speak": "<s>The forecast for Seattle January 20 is mostly clear with a High of 51 degrees and Low of 40 degrees</s>",
            "body": [{
                    "type": "Container",
                    "items": [{
                        "type": "TextBlock",
                        "text": "Seattle, Washington - January 20, 7:30 AM",
                        "isSubtle": true
                    }]
                },
                {
                    "type": "Container",
                    "items": [{
                        "type": "ColumnSet",
                        "columns": [{
                                "type": "Column",
                                "size": "auto",
                                "items": [{
                                    "type": "Image",
                                    "url": "http://messagecardplayground.azurewebsites.net/assets/Mostly Cloudy-Square.png",
                                    "size": "small",
                                    "horizontalAlignment": "center"
                                }]
                            },
                            {
                                "type": "Column",
                                "size": "auto",
                                "items": [{
                                        "type": "ColumnSet",
                                        "columns": [{
                                                "type": "Column",
                                                "size": "auto",
                                                "items": [{
                                                    "type": "TextBlock",
                                                    "text": "42",
                                                    "size": "extraLarge"
                                                }]
                                            },
                                            {
                                                "type": "Column",
                                                "size": "auto",
                                                "items": [{
                                                    "type": "TextBlock",
                                                    "text": "°F",
                                                    "weight": "bolder"
                                                }]
                                            }
                                        ]
                                    },
                                    {
                                        "type": "TextBlock",
                                        "text": "Mostly Clear",
                                        "isSubtle": true
                                    }
                                ]
                            },
                            {
                                "type": "Column",
                                "size": "auto",
                                "items": [{
                                        "type": "TextBlock",
                                        "text": "Hi 51"
                                    },
                                    {
                                        "type": "TextBlock",
                                        "text": "Lo 40"
                                    }
                                ]
                            }
                        ]
                    }],
                    "actions": [{
                            "type": "Action.ShowCard",
                            "title": "Comment",
                            "card": {
                                "type": "AdaptiveCard",
                                "body": [{
                                    "type": "Input.Text",
                                    "id": "comment",
                                    "isMultiline": true,
                                    "title": "Enter your comment"
                                }],
                                "actions": [{
                                    "type": "Action.Http",
                                    "method": "POST",
                                    "title": "OK",
                                    "url": "http://xyz.com",
                                    "headers": {
                                        "content-type": "application/json"
                                    },
                                    "body": "{ 'comment' : '{{comment.value}}' }"
                                }]
                            }
                        },
                        {
                            "type": "Action.OpenUrl",
                            "title": "View",
                            "url": "http://foo.com"
                        }
                    ]
                }
            ]
        };
    </script>

    <style type="text/css">
    
        #exampleDiv {
            border: 1px solid #ccc;
            margin: 40px;
            width: 360px;
        }

    </style>

</head>

<body>

    <h1>Adaptive Cards - Basic Example</h1>

    <div id="exampleDiv"></div>

    <script>
        AdaptiveCards.setConfiguration(configuration);

        var adaptiveCard = new AdaptiveCards.AdaptiveCard();
        adaptiveCard.parse(json);
        var renderedCard = adaptiveCard.render();

        var exampleDiv = document.getElementById('exampleDiv');
        exampleDiv.appendChild(renderedCard);

        AdaptiveCards.AdaptiveCard.onExecuteAction = function(action) {
            alert(JSON.stringify(action));
        };
    </script>

    <p>
        This example requires a build of the Adaptive Cards library. From the command line, enter "npm run build" which will put the built files in the /dist folder. Then refresh this page.
    </p>

</body>

</html>